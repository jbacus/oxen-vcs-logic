# Shell Completions for Auxin CLI

This directory contains shell completion scripts for `auxin`, enabling tab completion for commands, subcommands, and flags.

## Supported Shells

- **Bash** (`auxin.bash`)
- **Zsh** (`_auxin`)
- **Fish** (`auxin.fish`)
- **PowerShell** (`auxin.ps1`)

---

## Installation

### Bash

**macOS (with Homebrew):**
```bash
cp auxin.bash /usr/local/etc/bash_completion.d/
```

**Linux:**
```bash
sudo cp auxin.bash /etc/bash_completion.d/
```

**User-specific (any OS):**
```bash
mkdir -p ~/.local/share/bash-completion/completions
cp auxin.bash ~/.local/share/bash-completion/completions/auxin
```

Then add to `~/.bashrc` or `~/.bash_profile`:
```bash
if [ -f ~/.local/share/bash-completion/completions/auxin ]; then
    . ~/.local/share/bash-completion/completions/auxin
fi
```

---

### Zsh

**System-wide (with Homebrew):**
```bash
sudo cp _auxin /usr/local/share/zsh/site-functions/
```

**User-specific:**
```bash
mkdir -p ~/.zsh/completions
cp _auxin ~/.zsh/completions/
```

Then add to `~/.zshrc`:
```bash
fpath=(~/.zsh/completions $fpath)
autoload -Uz compinit
compinit
```

---

### Fish

```bash
mkdir -p ~/.config/fish/completions
cp auxin.fish ~/.config/fish/completions/
```

Fish will automatically load completions from this directory.

---

### PowerShell

Add to your PowerShell profile (`$PROFILE`):
```powershell
. /path/to/auxin.ps1
```

To find your profile path:
```powershell
echo $PROFILE
```

---

## Testing

After installation, restart your shell and test:

```bash
auxin <TAB>
# Should show: add, commit, init, log, etc.

auxin lock <TAB>
# Should show: acquire, release, status, break

auxin commit --<TAB>
# Should show: --message, --bpm, --key, --sample-rate, etc.
```

---

## Regenerating

If completions get out of sync with the CLI, regenerate them:

```bash
auxin completions bash > auxin.bash
auxin completions zsh > _auxin
auxin completions fish > auxin.fish
auxin completions powershell > auxin.ps1
```

---

## Troubleshooting

### Bash: Completions not working

1. Check if bash-completion is installed:
   ```bash
   brew install bash-completion@2  # macOS
   sudo apt install bash-completion  # Ubuntu/Debian
   ```

2. Ensure bash-completion is sourced in your shell config:
   ```bash
   if [ -f /usr/local/etc/bash_completion ]; then
       . /usr/local/etc/bash_completion
   fi
   ```

### Zsh: Completions not working

1. Ensure `compinit` is called in `~/.zshrc`:
   ```bash
   autoload -Uz compinit
   compinit
   ```

2. Clear completion cache:
   ```bash
   rm -f ~/.zcompdump*
   compinit
   ```

### Fish: Completions not working

Fish automatically loads completions. Try:
```bash
fish_update_completions
```

---

## Features

The completion scripts support:

- ✅ All commands and subcommands
- ✅ All flags and options
- ✅ Context-aware suggestions
- ✅ Argument value suggestions (where applicable)
- ✅ Help text in completions

---

## Examples

```bash
# Tab completion for commands
$ auxin <TAB>
add       commit    daemon    diff      help      lock      queue     status
auth      compare   delete    hooks     init      log       restore   team

# Tab completion for lock subcommands
$ auxin lock <TAB>
acquire  break  release  status

# Tab completion for flags
$ auxin commit --<TAB>
--all           --help         --key          --sample-rate  --verbose
--bpm           --message      --tags

# Tab completion for config
$ auxin queue <TAB>
clear   remove  status  sync
```

---

## Generated By

These completion scripts are generated automatically using `clap_complete`.
To regenerate or update, run:

```bash
./generate-completions.sh
```

Or manually:
```bash
auxin completions <shell> > completions/auxin.<ext>
```

---

*Last updated: 2025-11-17*
