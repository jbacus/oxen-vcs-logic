# Shell Completions for OxVCS CLI

This directory contains shell completion scripts for `oxenvcs-cli`, enabling tab completion for commands, subcommands, and flags.

## Supported Shells

- **Bash** (`oxenvcs-cli.bash`)
- **Zsh** (`_oxenvcs-cli`)
- **Fish** (`oxenvcs-cli.fish`)
- **PowerShell** (`oxenvcs-cli.ps1`)

---

## Installation

### Bash

**macOS (with Homebrew):**
```bash
cp oxenvcs-cli.bash /usr/local/etc/bash_completion.d/
```

**Linux:**
```bash
sudo cp oxenvcs-cli.bash /etc/bash_completion.d/
```

**User-specific (any OS):**
```bash
mkdir -p ~/.local/share/bash-completion/completions
cp oxenvcs-cli.bash ~/.local/share/bash-completion/completions/oxenvcs-cli
```

Then add to `~/.bashrc` or `~/.bash_profile`:
```bash
if [ -f ~/.local/share/bash-completion/completions/oxenvcs-cli ]; then
    . ~/.local/share/bash-completion/completions/oxenvcs-cli
fi
```

---

### Zsh

**System-wide (with Homebrew):**
```bash
sudo cp _oxenvcs-cli /usr/local/share/zsh/site-functions/
```

**User-specific:**
```bash
mkdir -p ~/.zsh/completions
cp _oxenvcs-cli ~/.zsh/completions/
```

Then add to `~/.zshrc`:
```bash
fpath=(~/.zsh/completions $fpath)
autoload -Uz compinit
compinit
```

---

### Fish

```bash
mkdir -p ~/.config/fish/completions
cp oxenvcs-cli.fish ~/.config/fish/completions/
```

Fish will automatically load completions from this directory.

---

### PowerShell

Add to your PowerShell profile (`$PROFILE`):
```powershell
. /path/to/oxenvcs-cli.ps1
```

To find your profile path:
```powershell
echo $PROFILE
```

---

## Testing

After installation, restart your shell and test:

```bash
oxenvcs-cli <TAB>
# Should show: add, commit, init, log, etc.

oxenvcs-cli lock <TAB>
# Should show: acquire, release, status, break

oxenvcs-cli commit --<TAB>
# Should show: --message, --bpm, --key, --sample-rate, etc.
```

---

## Regenerating

If completions get out of sync with the CLI, regenerate them:

```bash
oxenvcs-cli completions bash > oxenvcs-cli.bash
oxenvcs-cli completions zsh > _oxenvcs-cli
oxenvcs-cli completions fish > oxenvcs-cli.fish
oxenvcs-cli completions powershell > oxenvcs-cli.ps1
```

---

## Troubleshooting

### Bash: Completions not working

1. Check if bash-completion is installed:
   ```bash
   brew install bash-completion@2  # macOS
   sudo apt install bash-completion  # Ubuntu/Debian
   ```

2. Ensure bash-completion is sourced in your shell config:
   ```bash
   if [ -f /usr/local/etc/bash_completion ]; then
       . /usr/local/etc/bash_completion
   fi
   ```

### Zsh: Completions not working

1. Ensure `compinit` is called in `~/.zshrc`:
   ```bash
   autoload -Uz compinit
   compinit
   ```

2. Clear completion cache:
   ```bash
   rm -f ~/.zcompdump*
   compinit
   ```

### Fish: Completions not working

Fish automatically loads completions. Try:
```bash
fish_update_completions
```

---

## Features

The completion scripts support:

- ✅ All commands and subcommands
- ✅ All flags and options
- ✅ Context-aware suggestions
- ✅ Argument value suggestions (where applicable)
- ✅ Help text in completions

---

## Examples

```bash
# Tab completion for commands
$ oxenvcs-cli <TAB>
add       commit    daemon    diff      help      lock      queue     status
auth      compare   delete    hooks     init      log       restore   team

# Tab completion for lock subcommands
$ oxenvcs-cli lock <TAB>
acquire  break  release  status

# Tab completion for flags
$ oxenvcs-cli commit --<TAB>
--all           --help         --key          --sample-rate  --verbose
--bpm           --message      --tags

# Tab completion for config
$ oxenvcs-cli queue <TAB>
clear   remove  status  sync
```

---

## Generated By

These completion scripts are generated automatically using `clap_complete`.
To regenerate or update, run:

```bash
./generate-completions.sh
```

Or manually:
```bash
oxenvcs-cli completions <shell> > completions/oxenvcs-cli.<ext>
```

---

*Last updated: 2025-11-17*
